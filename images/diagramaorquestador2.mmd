%%{init: {"theme": "base", "themeVariables": {"background": "#ffffff", "primaryColor": "#ffffff", "primaryTextColor": "#000000"}}}%%
flowchart TD
    A[ğŸ¬ Inicio] --> B[ğŸ§  Agente ContextualizaciÃ³n]

    B -->|"âœ… avanzar<br/>(Query Lista)"| C[ğŸ”§ Agente GeneraciÃ³n SQL]
    B -->|"ğŸ”„ repetir<br/>(Necesita ClarificaciÃ³n)"| B

    C -->|"â–¶ï¸ ejecutar<br/>(SQL Generado)"| D[âš¡ Agente EjecuciÃ³n DB]

    D -->|"âœ… correcto<br/>(Datos OK)"| E[ğŸ¯ Agente InterpretaciÃ³n]
    D -->|"âŒ error<br/>(Fallo SQL)"| C
    D -->|"âš ï¸ sin_resultados<br/>(LÃ³gica VacÃ­a)"| B
    
    E --> F[ğŸ Fin]
    
    subgraph OrquestaciÃ³n Multi-Agente - LangGraph
        B
        C
        D
        E
    end
    
    style A fill:#f9f,stroke:#333,stroke-width:1px
    style B fill:#bbf,stroke:#333,stroke-width:2px
    style C fill:#bbf,stroke:#333,stroke-width:1px
    style D fill:#ffd,stroke:#333,stroke-width:2px
    style E fill:#bbf,stroke:#333,stroke-width:1px
    style F fill:#dfd,stroke:#333,stroke-width:1px